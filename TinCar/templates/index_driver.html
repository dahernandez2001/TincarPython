{% extends 'layout.html' %}

{% block content %}
<!-- Navbar dentro del contenido -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4 py-3 border-bottom border-secondary">
  <div class="container-fluid">
  <a class="navbar-brand d-flex align-items-center" href="{{ url_for('home') }}">
      <img src="{{ url_for('static', filename='img/logo.png') }}" alt="logo" width="45" class="me-2">
      <span class="fs-4 fw-bold text-warning">TinCar</span>
    </a>
    <div class="collapse navbar-collapse justify-content-end">
      <ul class="navbar-nav">
  <li class="nav-item"><a class="nav-link active" href="{{ url_for('home') }}">Inicio</a></li>
  <li class="nav-item"><a class="nav-link" href="{{ url_for('home') }}">Arrendar</a></li>
  <li class="nav-item"><a class="nav-link" href="{{ url_for('home') }}">Configuración</a></li>
      </ul>
    </div>
  </div>
</nav>

<main class="container py-5 text-light">

  <!-- Bienvenida -->
  <div class="text-center mb-4">
    <h1 class="fw-bold" style="color: #FFB300;">Bienvenido, {{ session.get('user_name') or session.get('name') or 'Usuario' }}</h1>
    <h5 class="text-secondary">
      Estás registrado como <span class="fw-semibold text-info">Conductor</span>.
    </h5>
  </div>

  <!-- Tarjeta principal -->
  <div class="card bg-black text-light p-4 rounded-4 shadow-lg border border-secondary mx-auto" style="max-width: 900px;">
    <div class="d-flex justify-content-between align-items-center flex-wrap mb-4">
      <div>
        <h2 class="fw-bold">Modo conductor</h2>
        <p class="text-secondary">({{ session.get('user_name') or session.get('name') or 'nombre de usuario' }})</p>
      </div>

      <div class="d-flex align-items-center mt-3 mt-md-0">
        <div class="info-box text-center me-4">
          <div class="bg-secondary bg-opacity-25 p-3 rounded-4">
            <p class="mb-1">Calificación</p>
            <p class="fs-4 mb-0 text-warning">⭐ <span id="rating-sum">0</span></p>
            <hr class="text-secondary my-2">
            <p class="mb-1">Reservas</p>
            <p class="fs-4 mb-0"><span id="reservations-count">0</span></p>
          </div>
        </div>
        <div class="text-center">
          <div class="profile-circle mx-auto mb-2"></div>
          <a href="{{ url_for('dashboard') }}" class="btn btn-warning fw-bold rounded-3 px-4">Perfil</a>
        </div>
      </div>
    </div>

    <!-- Mapa -->
      <!-- Mapa: usaremos Leaflet para mostrar los parqueaderos activos -->
      <div class="map-container">
        <div id="map" style="width:100%; height:400px; border-radius:8px; overflow:hidden;"></div>
      </div>
  </div>

  <!-- Botón cerrar sesión -->
  <div class="mt-5 text-center">
    <a href="{{ url_for('logout') }}" class="btn btn-outline-light px-4 py-2">
      Cerrar sesión
    </a>
  </div>
</main>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <!-- Leaflet JS (mapas) -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="{{ url_for('static', filename='js/driver.js') }}"></script>
{% endblock %}
